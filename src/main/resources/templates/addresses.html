<!DOCTYPE html>
<!--suppress HtmlUnknownAttribute -->
<html xmlns:th="http://www.thymeleaf.org">
	<head lang="en">
		<!-- Required meta tags -->
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	    <meta charset="utf-8">
	    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

		<link href="http://cdn.jsdelivr.net/webjars/bootstrap/4.1.3/css/bootstrap.min.css"
			th:href="@{/webjars/bootstrap/4.1.3/css/bootstrap.min.css}" rel="stylesheet" />

		<link href="../static/css/addresses.css" th:href="@{/css/addresses.css}" rel="stylesheet" />

		<link rel="icon" type="image/jpg" href="../static/images/logo.jpg" th:href="@{/images/logo.jpg}" />

		<title th:text="${appName}">Bedding Plants</title>
	</head>
	<body>
		<div id="map"></div>
		<script src="../static/js/GoogleMaps.js" th:src="@{/js/GoogleMaps.js}"></script>
		<script th:inline="javascript">
		  function initMap() {
			var scoutHutLat = /*[[${scoutHutLat}]]*/ 53.48;
			var scoutHutLng = /*[[${scoutHutLng}]]*/ -2.14;
			var defaultZoom = /*[[${defaultZoom}]]*/ 15;
			
			var viewportMaxLat = /*[[${viewportMaxLat}]]*/ 54;
			var viewportMinLat = /*[[${viewportMinLat}]]*/ 53;
			var viewportMaxLng = /*[[${viewportMaxLng}]]*/ -3;
			var viewportMinLng = /*[[${viewportMinLng}]]*/ -2;

			var mapTypeId = /*[(${mapTypeId})]*/ google.maps.MapTypeId.ROADMAP;
			mapLoadViewer('map', mapTypeId, viewportMaxLat, viewportMinLat, viewportMaxLng, viewportMinLng, loadMapPoints);
		  }
		</script>
		<script th:inline="javascript">
			var geolocatedPoints = /*[[${geolocatedPoints}]]*/ null;

			function loadMapPoints() {
				console.log("Loading map points");
				
				// check we have addresses to plot, otherwise finish
				if (geolocatedPoints == null) {
					return;
				}

				// add each point to the map as a circle
				for (var p in geolocatedPoints) {
					var point = geolocatedPoints[p];
					addCircleToMap(point.lat, point.lng, point.mapMarkerSize.pixels, point.mapMarkerColour, point.description);
				}
			}
		</script>
		<script th:src="@{${'https://maps.googleapis.com/maps/api/js?key=' + googleApiKey + '&callback=initMap'}}" async defer></script>
	</body>
</html>